public static void model_1(byte[] bytes, out int codePage, out double prob) {
  int ngsize, ngram, idx = 0;
  ngsize=1;
  var rates = new Dictionary<int,double>();
  rates[65001] = -1.44278655120139;
  rates[12000] = -0.151406761111355;
  rates[1251] = -2.0352126127059;
  rates[866] = -2.0352126127059;
  rates[20866] = -2.0352126127059;
  while (true) {
    if ((idx+ngsize)<=bytes.Length) {
      ngram=0;
      ngram=(ngram<<8)+bytes[idx+0];
    } else {
      ngram=-1;
    }
    if (ngram==-1) break;
    switch(ngram) {
      case 13:
        rates[65001]+=-1.38629436111989;
        rates[12000]+=-1.38629436111989;
        rates[1251]+=-1.38629436111989;
        rates[866]+=-1.38629436111989;
        rates[20866]+=-1.38629436111989;
        break;
      case 10:
        rates[65001]+=-1.38629436111989;
        rates[12000]+=-1.38629436111989;
        rates[1251]+=-1.38629436111989;
        rates[866]+=-1.38629436111989;
        rates[20866]+=-1.38629436111989;
        break;
      case 32:
        rates[65001]+=-1.39964547734619;
        rates[12000]+=-1.33392721019069;
        rates[1251]+=-1.39964547734619;
        rates[866]+=-1.39964547734619;
        rates[20866]+=-1.39964547734619;
        break;
      case 209:
        rates[65001]+=1.36415644856574;
        rates[12000]+=-14.3205862826986;
        rates[1251]+=-1.77094626860764;
        rates[866]+=-14.3205862826986;
        rates[20866]+=-2.78500816683404;
        break;
      case 130:
        rates[65001]+=0.238715113457985;
        rates[12000]+=-13.076526747256;
        rates[1251]+=-13.076526747256;
        rates[866]+=-0.238740598773113;
        rates[20866]+=-13.076526747256;
        break;
      case 208:
        rates[65001]+=3.22506756289476;
        rates[12000]+=-15.8926356687886;
        rates[1251]+=-3.71039377924538;
        rates[866]+=-15.8926356687886;
        rates[20866]+=-4.22959031949027;
        break;
      case 190:
        rates[65001]+=11.7731798128257;
        rates[12000]+=-13.15947995534;
        rates[1251]+=-13.15947995534;
        rates[866]+=-13.15947995534;
        rates[20866]+=-13.15947995534;
        break;
      case 187:
        rates[65001]+=10.9416595773921;
        rates[12000]+=-12.3279672172263;
        rates[1251]+=-12.3279672172263;
        rates[866]+=-12.3279672172263;
        rates[20866]+=-12.3279672172263;
        break;
      case 129:
        rates[65001]+=1.13354171283358;
        rates[12000]+=-12.6720149136024;
        rates[1251]+=-12.6720149136024;
        rates[866]+=-1.13359281293467;
        rates[20866]+=-12.6720149136024;
        break;
      case 181:
        rates[65001]+=11.4630706092137;
        rates[12000]+=-12.8493728536955;
        rates[1251]+=-12.8493728536955;
        rates[866]+=-12.8493728536955;
        rates[20866]+=-12.8493728536955;
        break;
      case 189:
        rates[65001]+=11.2177352770277;
        rates[12000]+=-12.604039713461;
        rates[1251]+=-12.604039713461;
        rates[866]+=-12.604039713461;
        rates[20866]+=-12.604039713461;
        break;
      case 184:
        rates[65001]+=7.86802989787349;
        rates[12000]+=-12.6219995048489;
        rates[1251]+=-7.89424216990172;
        rates[866]+=-12.6219995048489;
        rates[20866]+=-12.6219995048489;
        break;
      case 176:
        rates[65001]+=11.4334817445339;
        rates[12000]+=-12.8197842257563;
        rates[1251]+=-12.8197842257563;
        rates[866]+=-12.8197842257563;
        rates[20866]+=-12.8197842257563;
        break;
      case 46:
        rates[65001]+=-1.44249698414734;
        rates[12000]+=-1.17826607492916;
        rates[1251]+=-1.44249698414734;
        rates[866]+=-1.44249698414734;
        rates[20866]+=-1.44249698414734;
        break;
      case 62:
        rates[65001]+=-7.11065386518322;
        rates[12000]+=5.72190741707132;
        rates[1251]+=-7.11065386518322;
        rates[866]+=-7.11065386518322;
        rates[20866]+=-7.11065386518322;
        break;
      case 128:
        rates[65001]+=-0.661715553524595;
        rates[12000]+=-13.2358349096511;
        rates[1251]+=-13.2358349096511;
        rates[866]+=0.661691695924352;
        rates[20866]+=-13.2358349096511;
        break;
      case 45:
        rates[65001]+=-1.41108221393272;
        rates[12000]+=-1.29062924112554;
        rates[1251]+=-1.41108221393272;
        rates[866]+=-1.41108221393272;
        rates[20866]+=-1.41108221393272;
        break;
      case 48:
        rates[65001]+=-5.20051079442307;
        rates[12000]+=3.79753685743268;
        rates[1251]+=-5.20051079442307;
        rates[866]+=-5.20051079442307;
        rates[20866]+=-5.20051079442307;
        break;
      case 139:
        rates[65001]+=-0.969405788175426;
        rates[12000]+=-12.649546193824;
        rates[1251]+=-12.649546193824;
        rates[866]+=0.969357502606355;
        rates[20866]+=-12.649546193824;
        break;
      case 50:
        rates[65001]+=-4.42696886845253;
        rates[12000]+=3.00416406247809;
        rates[1251]+=-4.42696886845253;
        rates[866]+=-4.42696886845253;
        rates[20866]+=-4.42696886845253;
        break;
      case 53:
        rates[65001]+=-5.58177920612498;
        rates[12000]+=4.18412296466085;
        rates[1251]+=-5.58177920612498;
        rates[866]+=-5.58177920612498;
        rates[20866]+=-5.58177920612498;
        break;
      case 44:
        rates[65001]+=-1.46727206161891;
        rates[12000]+=-1.0955767528528;
        rates[1251]+=-1.46727206161891;
        rates[866]+=-1.46727206161891;
        rates[20866]+=-1.46727206161891;
        break;
      case 56:
        rates[65001]+=-5.14901379518672;
        rates[12000]+=3.74515062148421;
        rates[1251]+=-5.14901379518672;
        rates[866]+=-5.14901379518672;
        rates[20866]+=-5.14901379518672;
        break;
      case 61:
        rates[65001]+=-8.3708462823255;
        rates[12000]+=6.98385712126834;
        rates[1251]+=-8.3708462823255;
        rates[866]+=-8.3708462823255;
        rates[20866]+=-8.3708462823255;
        break;
      case 136:
        rates[65001]+=-2.00651703427221;
        rates[12000]+=-12.7477804673078;
        rates[1251]+=-12.7477804673078;
        rates[866]+=2.00643351048925;
        rates[20866]+=-12.7477804673078;
        break;
      case 133:
        rates[65001]+=-2.27797900846526;
        rates[12000]+=-12.9469427542991;
        rates[1251]+=-12.9469427542991;
        rates[866]+=2.27789421090518;
        rates[20866]+=-12.9469427542991;
        break;
      case 142:
        rates[65001]+=-2.86476145472353;
        rates[12000]+=-13.2149097413859;
        rates[1251]+=-13.2149097413859;
        rates[866]+=2.86465424487326;
        rates[20866]+=-13.2149097413859;
        break;
      case 141:
        rates[65001]+=-3.02034428729487;
        rates[12000]+=-12.6516683091697;
        rates[1251]+=-12.6516683091697;
        rates[866]+=3.02012770707668;
        rates[20866]+=-12.6516683091697;
        break;
      case 59:
        rates[65001]+=-3.59124803681467;
        rates[12000]+=2.11864199074395;
        rates[1251]+=-3.59124803681467;
        rates[866]+=-3.59124803681467;
        rates[20866]+=-3.59124803681467;
        break;
      case 34:
        rates[65001]+=-3.32644857897015;
        rates[12000]+=1.82613258910469;
        rates[1251]+=-3.32644857897015;
        rates[866]+=-3.32644857897015;
        rates[20866]+=-3.32644857897015;
        break;
      case 33:
        rates[65001]+=-3.37578912979085;
        rates[12000]+=1.88127084706562;
        rates[1251]+=-3.37578912979085;
        rates[866]+=-3.37578912979085;
        rates[20866]+=-3.37578912979085;
        break;
      case 0:
        rates[65001]+=-17.2898996635815;
        rates[12000]+=15.9036052097116;
        rates[1251]+=-17.2898996635815;
        rates[866]+=-17.2898996635815;
        rates[20866]+=-17.2898996635815;
        break;
      case 66:
        rates[65001]+=-5.4737696233985;
        rates[12000]+=4.07480922376248;
        rates[1251]+=-5.4737696233985;
        rates[866]+=-5.4737696233985;
        rates[20866]+=-5.4737696233985;
        break;
      case 4:
        rates[65001]+=-16.0123037089162;
        rates[12000]+=14.6260090143584;
        rates[1251]+=-16.0123037089162;
        rates[866]+=-16.0123037089162;
        rates[20866]+=-16.0123037089162;
        break;
      case 65:
        rates[65001]+=-3.76444695137548;
        rates[12000]+=2.30607501690845;
        rates[1251]+=-3.76444695137548;
        rates[866]+=-3.76444695137548;
        rates[20866]+=-3.76444695137548;
        break;
      case 242:
        rates[65001]+=-13.0341789490225;
        rates[12000]+=-13.0341789490225;
        rates[1251]+=0.337548543263509;
        rates[866]+=-13.0341789490225;
        rates[20866]+=-0.337575509588678;
        break;
      case 238:
        rates[65001]+=-13.6485547411999;
        rates[12000]+=-13.6485547411999;
        rates[1251]+=0.460737838614199;
        rates[866]+=-3.31826207893429;
        rates[20866]+=-0.610880103237906;
        break;
      case 235:
        rates[65001]+=-13.0482409436076;
        rates[12000]+=-13.0482409436076;
        rates[1251]+=-0.0535666948682441;
        rates[866]+=-1.48563182685206;
        rates[20866]+=-0.71359078956618;
        break;
      case 241:
        rates[65001]+=-12.7291518861425;
        rates[12000]+=-12.7291518861425;
        rates[1251]+=0.915616643294135;
        rates[866]+=-8.00143210442913;
        rates[20866]+=-0.917286665228947;
        break;
      case 233:
        rates[65001]+=-12.8109540262774;
        rates[12000]+=-12.8109540262774;
        rates[1251]+=-1.85843908875519;
        rates[866]+=-3.24238240751709;
        rates[20866]+=1.5680669661867;
        break;
      case 229:
        rates[65001]+=-13.5924894991476;
        rates[12000]+=-13.5924894991476;
        rates[1251]+=-0.0975777839614283;
        rates[866]+=-2.97112093346022;
        rates[20866]+=-0.0975777839614283;
        break;
      case 226:
        rates[65001]+=-12.1284750018056;
        rates[12000]+=-13.2270908927597;
        rates[1251]+=-0.493746626733392;
        rates[866]+=-0.0752112700947291;
        rates[20866]+=-1.81715668362609;
        break;
      case 237:
        rates[65001]+=-13.004642339826;
        rates[12000]+=-13.004642339826;
        rates[1251]+=0.707768797976911;
        rates[866]+=-3.38772179809306;
        rates[20866]+=-0.859680313493659;
        break;
      case 232:
        rates[65001]+=-12.8552418149177;
        rates[12000]+=-12.8552418149177;
        rates[1251]+=1.33495552922642;
        rates[866]+=-2.12758463199451;
        rates[20866]+=-2.17638662207749;
        break;
      case 224:
        rates[65001]+=-13.2872928990887;
        rates[12000]+=-13.2872928990887;
        rates[1251]+=0.517466437244572;
        rates[866]+=-0.738723208783759;
        rates[20866]+=-2.94111640903461;
        break;
      case 247:
        rates[65001]+=-12.5411188658733;
        rates[12000]+=-12.5411188658733;
        rates[1251]+=-1.11259531794111;
        rates[866]+=-12.5411188658733;
        rates[20866]+=1.11253769098935;
        break;
      case 240:
        rates[65001]+=-12.6289519098921;
        rates[12000]+=-12.6289519098921;
        rates[1251]+=0.508472995886598;
        rates[866]+=-7.90119713553143;
        rates[20866]+=-0.510079689466205;
        break;
      case 225:
        rates[65001]+=-13.4416051615638;
        rates[12000]+=-13.4416051615638;
        rates[1251]+=-2.06255939820624;
        rates[866]+=-0.617953649221523;
        rates[20866]+=0.148112678183055;
        break;
      case 243:
        rates[65001]+=-12.8001119441351;
        rates[12000]+=-12.8001119441351;
        rates[1251]+=-0.686719429022639;
        rates[866]+=-12.8001119441351;
        rates[20866]+=0.686682242514971;
        break;
      case 228:
        rates[65001]+=-12.5492225369046;
        rates[12000]+=-12.5492225369046;
        rates[1251]+=-0.051970527370649;
        rates[866]+=-3.6244083167644;
        rates[20866]+=-0.051970527370649;
        break;
      case 231:
        rates[65001]+=-12.3396940341049;
        rates[12000]+=-12.3396940341049;
        rates[1251]+=-0.714457648795837;
        rates[866]+=-0.834993804426257;
        rates[20866]+=-0.537426504253572;
        break;
      case 239:
        rates[65001]+=-13.5004970275636;
        rates[12000]+=-13.5004970275636;
        rates[1251]+=-1.68119189186154;
        rates[866]+=-1.88323384865376;
        rates[20866]+=0.90044861195765;
        break;
      case 236:
        rates[65001]+=-13.0068492657919;
        rates[12000]+=-13.0068492657919;
        rates[1251]+=-0.862819953192032;
        rates[866]+=-1.41104561581056;
        rates[20866]+=0.0287052069190389;
        break;
      case 244:
        rates[65001]+=-12.522673752509;
        rates[12000]+=-12.522673752509;
        rates[1251]+=-3.59714197217373;
        rates[866]+=-12.522673752509;
        rates[20866]+=3.59672104719932;
        break;
      case 174:
        rates[65001]+=-2.86476145472353;
        rates[12000]+=-13.2149097413859;
        rates[1251]+=-13.2149097413859;
        rates[866]+=2.86465424487326;
        rates[20866]+=-13.2149097413859;
        break;
      case 171:
        rates[65001]+=-0.969405788175426;
        rates[12000]+=-12.649546193824;
        rates[1251]+=-12.649546193824;
        rates[866]+=0.969357502606355;
        rates[20866]+=-12.649546193824;
        break;
      case 165:
        rates[65001]+=-2.27798163623739;
        rates[12000]+=-12.9469451377911;
        rates[1251]+=-12.2537955737392;
        rates[866]+=2.27786857415233;
        rates[20866]+=-12.9469451377911;
        break;
      case 162:
        rates[65001]+=0.238715113457985;
        rates[12000]+=-13.076526747256;
        rates[1251]+=-13.076526747256;
        rates[866]+=-0.238740598773113;
        rates[20866]+=-13.076526747256;
        break;
      case 173:
        rates[65001]+=-3.02034428729487;
        rates[12000]+=-12.6516683091697;
        rates[1251]+=-12.6516683091697;
        rates[866]+=3.02012770707668;
        rates[20866]+=-12.6516683091697;
        break;
      case 168:
        rates[65001]+=-2.00688655050709;
        rates[12000]+=-12.7481061964204;
        rates[1251]+=-8.02039264859542;
        rates[866]+=2.0036887470947;
        rates[20866]+=-12.7481061964204;
        break;
      case 160:
        rates[65001]+=-0.661715553524595;
        rates[12000]+=-13.2358349096511;
        rates[1251]+=-13.2358349096511;
        rates[866]+=0.661691695924352;
        rates[20866]+=-13.2358349096511;
        break;
      case 161:
        rates[65001]+=1.13307706158332;
        rates[12000]+=-12.6716634274715;
        rates[1251]+=-12.6716634274715;
        rates[866]+=-1.13312816746739;
        rates[20866]+=-12.6716634274715;
        break;
      case 212:
        rates[65001]+=-12.522673752509;
        rates[12000]+=-12.522673752509;
        rates[1251]+=-3.59714197217373;
        rates[866]+=-12.522673752509;
        rates[20866]+=3.59672104719932;
        break;
      case 207:
        rates[65001]+=-13.3589142475941;
        rates[12000]+=-13.3589142475941;
        rates[1251]+=-1.51088787894824;
        rates[866]+=-13.3589142475941;
        rates[20866]+=1.51085590388149;
        break;
      case 204:
        rates[65001]+=-12.7886094428501;
        rates[12000]+=-12.7886094428501;
        rates[1251]+=-0.535979221550189;
        rates[866]+=-12.7886094428501;
        rates[20866]+=0.535943248316221;
        break;
      case 211:
        rates[65001]+=-12.8001119441351;
        rates[12000]+=-12.8001119441351;
        rates[1251]+=-0.686719429022639;
        rates[866]+=-12.8001119441351;
        rates[20866]+=0.686682242514971;
        break;
      case 197:
        rates[65001]+=-13.5425147786905;
        rates[12000]+=-13.5425147786905;
        rates[1251]+=-7.88335783751929E-06;
        rates[866]+=-13.5425147786905;
        rates[20866]+=-7.88335783751929E-06;
        break;
      case 215:
        rates[65001]+=-12.5411188658733;
        rates[12000]+=-12.5411188658733;
        rates[1251]+=-1.11259531794111;
        rates[866]+=-12.5411188658733;
        rates[20866]+=1.11253769098935;
        break;
      case 206:
        rates[65001]+=-13.6129805795508;
        rates[12000]+=-13.6129805795508;
        rates[1251]+=0.555434460479516;
        rates[866]+=-13.6129805795508;
        rates[20866]+=-0.555450317191983;
        break;
      case 201:
        rates[65001]+=-12.7726299992398;
        rates[12000]+=-12.7726299992398;
        rates[1251]+=-1.81400526037635;
        rates[866]+=-12.7726299992398;
        rates[20866]+=1.81393462892371;
        break;
      case 203:
        rates[65001]+=-12.8441932559029;
        rates[12000]+=-12.8441932559029;
        rates[1251]+=0.391978882677316;
        rates[866]+=-12.8441932559029;
        rates[20866]+=-0.392011812968406;
        break;
      case 193:
        rates[65001]+=-13.0104436190934;
        rates[12000]+=-13.0104436190934;
        rates[1251]+=-1.5604099745217;
        rates[866]+=-13.0104436190934;
        rates[20866]+=1.56036319736603;
        break;
      case 210:
        rates[65001]+=-11.9355666603544;
        rates[12000]+=-13.0341833177711;
        rates[1251]+=0.337538051735418;
        rates[866]+=-13.0341833177711;
        rates[20866]+=-0.33758299540306;
        break;
      case 194:
        rates[65001]+=-12.570837279512;
        rates[12000]+=-12.570837279512;
        rates[1251]+=0.997490674758714;
        rates[866]+=-12.570837279512;
        rates[20866]+=-0.997543588301149;
        break;
      case 196:
        rates[65001]+=-12.522910526411;
        rates[12000]+=-12.522910526411;
        rates[1251]+=-2.18533856365938E-05;
        rates[866]+=-12.522910526411;
        rates[20866]+=-2.18533856365938E-05;
        break;
      case 205:
        rates[65001]+=-12.9714172242592;
        rates[12000]+=-12.9714172242592;
        rates[1251]+=0.812018947951526;
        rates[866]+=-12.9714172242592;
        rates[20866]+=-0.812051717784899;
        break;
      case 200:
        rates[65001]+=-12.7426975863364;
        rates[12000]+=-12.7426975863364;
        rates[1251]+=2.05014932954733;
        rates[866]+=-12.7426975863364;
        rates[20866]+=-2.05023614338378;
        break;
      case 192:
        rates[65001]+=-12.8967918810155;
        rates[12000]+=-12.8967918810155;
        rates[1251]+=2.52495617658733;
        rates[866]+=-12.8967918810155;
        rates[20866]+=-2.52506572513982;
        break;
      case 158:
        rates[65001]+=2.86465424487326;
        rates[12000]+=-13.2149097413859;
        rates[1251]+=-13.2149097413859;
        rates[866]+=-2.86476145472353;
        rates[20866]+=-13.2149097413859;
        break;
      case 155:
        rates[65001]+=0.969357502606355;
        rates[12000]+=-12.649546193824;
        rates[1251]+=-12.649546193824;
        rates[866]+=-0.969405788175426;
        rates[20866]+=-12.649546193824;
        break;
      case 149:
        rates[65001]+=2.27789421090518;
        rates[12000]+=-12.9469427542991;
        rates[1251]+=-12.9469427542991;
        rates[866]+=-2.27797900846526;
        rates[20866]+=-12.9469427542991;
        break;
      case 146:
        rates[65001]+=-0.238740598773113;
        rates[12000]+=-13.076526747256;
        rates[1251]+=-13.076526747256;
        rates[866]+=0.238715113457985;
        rates[20866]+=-13.076526747256;
        break;
      case 157:
        rates[65001]+=3.02012770707668;
        rates[12000]+=-12.6516683091697;
        rates[1251]+=-12.6516683091697;
        rates[866]+=-3.02034428729487;
        rates[20866]+=-12.6516683091697;
        break;
      case 152:
        rates[65001]+=2.00643351048925;
        rates[12000]+=-12.7477804673078;
        rates[1251]+=-12.7477804673078;
        rates[866]+=-2.00651703427221;
        rates[20866]+=-12.7477804673078;
        break;
      case 144:
        rates[65001]+=0.661689156854447;
        rates[12000]+=-12.5426895145488;
        rates[1251]+=-13.2358384805631;
        rates[866]+=-0.66172096688911;
        rates[20866]+=-13.2358384805631;
        break;
      case 145:
        rates[65001]+=-1.13167726563414;
        rates[12000]+=-11.9788708707551;
        rates[1251]+=-12.6720211890178;
        rates[866]+=1.13160919976228;
        rates[20866]+=-12.6720211890178;
        break;
      case 30:
        rates[65001]+=-13.15947995534;
        rates[12000]+=11.7731798128257;
        rates[1251]+=-13.15947995534;
        rates[866]+=-13.15947995534;
        rates[20866]+=-13.15947995534;
        break;
      case 27:
        rates[65001]+=-12.3279672172263;
        rates[12000]+=10.9416595773921;
        rates[1251]+=-12.3279672172263;
        rates[866]+=-12.3279672172263;
        rates[20866]+=-12.3279672172263;
        break;
      case 21:
        rates[65001]+=-12.8493728536955;
        rates[12000]+=11.4630706092137;
        rates[1251]+=-12.8493728536955;
        rates[866]+=-12.8493728536955;
        rates[20866]+=-12.8493728536955;
        break;
      case 29:
        rates[65001]+=-12.604039713461;
        rates[12000]+=11.2177352770277;
        rates[1251]+=-12.604039713461;
        rates[866]+=-12.604039713461;
        rates[20866]+=-12.604039713461;
        break;
      case 24:
        rates[65001]+=-12.6216299886141;
        rates[12000]+=11.2353257278609;
        rates[1251]+=-12.6216299886141;
        rates[866]+=-12.6216299886141;
        rates[20866]+=-12.6216299886141;
        break;
      case 16:
        rates[65001]+=-12.8197842257563;
        rates[12000]+=11.4334817445339;
        rates[1251]+=-12.8197842257563;
        rates[866]+=-12.8197842257563;
        rates[20866]+=-12.8197842257563;
        break;
    }
    idx++;
  }
  var keys = rates.Keys.ToArray();
  var pSum = 0.0;
  foreach (var key in keys)
  {
    var x = Math.Exp(Math.Max(-50, Math.Min(100.0, rates[key])));
    var p = x / (1.0 + x);
    pSum += p;
    rates[key] = p;
  }
  codePage = -1;
  prob=0.0;
  foreach (var pair in rates)
  {
    if (codePage != -1 && rates[codePage] >= pair.Value) continue;
    codePage = pair.Key;
  }
  if (codePage != -1) prob=rates[codePage];
}
